<div class="upload-wrap">
  <div
    class="drop-zone"
    [class.dragging]="isDragging()"
    [class.has-file]="file()"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave()"
    (drop)="onDrop($event)"
  >
    <div class="corner tl"></div>
    <div class="corner tr"></div>
    <div class="corner bl"></div>
    <div class="corner br"></div>

    <div class="inner" *ngIf="!file()">
      <div class="icon-wrap">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="17 8 12 3 7 8"/>
          <line x1="12" y1="3" x2="12" y2="15"/>
        </svg>
      </div>
      <p class="headline">DROP LOG FILE HERE</p>
      <p class="sub">or <label class="browse-label" for="file-input">browse files</label></p>
      <p class="formats">.log · .txt · .out</p>
    </div>

    <div class="file-preview" *ngIf="file()">
      <div class="file-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
          <polyline points="10 9 9 9 8 9"/>
        </svg>
      </div>
      <div class="file-info">
        <span class="file-name mono">{{ file()!.name }}</span>
        <span class="file-size">{{ formatSize(file()!.size) }}</span>
      </div>
      <button class="clear-btn" (click)="file.set(null)">✕</button>
    </div>

    <input
      id="file-input"
      type="file"
      accept=".log,.txt,.out,text/plain"
      hidden
      (change)="onFileInput($event)"
    >
  </div>

  <div class="error-msg" *ngIf="error()">
    <span class="badge badge-red">ERROR</span>
    {{ error() }}
  </div>

  <button
    class="upload-btn"
    [disabled]="!file() || isUploading()"
    (click)="upload()"
  >
    <span *ngIf="!isUploading()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="17 8 12 3 7 8"/>
        <line x1="12" y1="3" x2="12" y2="15"/>
      </svg>
      ANALYZE LOG
    </span>
    <span class="loading-text" *ngIf="isUploading()">
      <span class="spinner"></span>
      PROCESSING...
    </span>
  </button>
</div>
